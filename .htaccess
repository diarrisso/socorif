# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress

# BEGIN Upload Size Limits
<IfModule mod_php.c>
php_value upload_max_filesize 64M
php_value post_max_size 64M
php_value max_execution_time 300
php_value max_input_time 300
php_value memory_limit 256M
</IfModule>

<IfModule mod_php7.c>
php_value upload_max_filesize 64M
php_value post_max_size 64M
php_value max_execution_time 300
php_value max_input_time 300
php_value memory_limit 256M
</IfModule>

<IfModule mod_php8.c>
php_value upload_max_filesize 64M
php_value post_max_size 64M
php_value max_execution_time 300
php_value max_input_time 300
php_value memory_limit 256M
</IfModule>
# END Upload Size Limits

# BEGIN Security Headers
<IfModule mod_headers.c>
    # Verhindert MIME-Type-Sniffing
    Header always set X-Content-Type-Options "nosniff"

    # Schutz gegen Clickjacking
    Header always set X-Frame-Options "SAMEORIGIN"

    # XSS-Schutz (Legacy, moderne Browser nutzen CSP)
    Header always set X-XSS-Protection "1; mode=block"

    # HSTS - HTTP Strict Transport Security
    # Erzwingt HTTPS für 1 Jahr (31536000 Sekunden)
    # WICHTIG: Nur aktivieren wenn die Seite komplett auf HTTPS läuft!
    # Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" env=HTTPS

    # Referrer Policy - Kontrolliert Informationsweitergabe
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # Permissions Policy - Beschränkt Browser-Features
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=()"

    # Content Security Policy (CSP)
    # HINWEIS: Dies ist eine moderate CSP. Für Produktion anpassen!
    # Erlaubt: Scripts/Styles von gleicher Quelle, inline Styles mit unsafe-inline (für TailwindCSS),
    # externe Ressourcen von CDNs (Alpine.js, Swiper, Google Fonts)
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://www.googletagmanager.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self';"
</IfModule>
# END Security Headers

# BEGIN Gzip Compression
<IfModule mod_deflate.c>
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/x-javascript application/json
</IfModule>
# END Gzip Compression
